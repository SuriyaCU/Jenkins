stage('Update Deployment Manifest') {
    steps {
        dir('java-maven-sonar-argocd-helm-k8s/spring-boot-app-manifests') {
            script {
                if (fileExists('deployment.yml')) {
                    sh "sed -i 's|image: .*|image: ${DOCKER_IMAGE}:${DOCKER_TAG}|' deployment.yml"
                } else {
                    echo "deployment.yml not found, skipping image update"
                }
            }
        }
    }
}
